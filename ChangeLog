2007-05-19  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-error.h:
	* libinfinity/common/inf-error.c: Added INF_USER_LEAVE_NO_SUCH_USER
	error code, InfRequestError codes and public API to access error
	quarks.

	* libinfinity/server/infd-session.h:
	* libinfinity/server/infd-session.c: Made xmlNodePtr non-const in
	InfdSessionMessageFunc because it only makes the pointer const (and
	not the XML node pointed to).

	* libinfinity/client/infc-request.h:
	* libinfinity/client/infc-request.c: Added a general request-specific
	pointer parameter to the succeeded signal.

	* docs/terminology: Added a few words about request and seq.

2007-04-18  Armin Burgmeier  <armin@arbur.net>

	* configure.ac:
	* libinfinity/Makefile.am: Added client directory, create
	libinfinity/client/Makefile.

	* libinfinity/inf-marshal.in: Added VOID:VOID marshaller.

	* libinfinity/common/infd-request.h:
	* libinfinity/common/infd-request.c:
	* libinfinity/common/Makefile.am: Added InfcRequest class.

	* libinfinity/common/inf-session.h:
	* libinfinity/common/inf-session.c:
	* libinfinity/server/infd-session.c: Replace user_to_xml vfunc by
	set_xml_user_props, added inf_session_user_to_xml which implements the
	functionality via the new vfunc.

2007-04-12  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/test/inf-test-daemon.c:
	* libinfinity/test/Makefile.am: Added test file that launches a simple
	infinote daemon with a filesystem storage in $HOME/.infinote.

2007-04-12  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/server/infd-filesystem-storage.h:
	* libinfinity/server/infd-filesystem-storage.c:
	* libinfinity/server/Makefile.am: Added a simple storage
	implementation that maps the directory tree to the disk.

2007-04-11  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/server/infd-server-pool.h:
	* libinfinity/server/infd-server-pool.c:
	* libinfinity/server/Makefile.am: Renamed from
	infd-server.[ch], manages an arbitrary amount of InfdXmlServers.

2007-04-10  Armin Burgmeier  <armin@arbur.net>

	* libinfintiy/common/inf-connection-manager.h:
	* libinfintiy/common/inf-connection-manager.c: Removed
	inf_connection_manager_add_connection, and add connection
	automatically on first invocation of
	inf_connection_manager_add_object.

	* libinfinity/common/inf-session.c:
	* libinfinity/server/infd-directory.c: Adjusted use.

2007-04-10  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-xmpp-connection.c: Fixed bugs, server side
	mostly works.

	* libinfinity/server/infd-xml-server.h: Fixed typo in
	InfdXmlServerStatus typedef.

	* libinfinity/server/infd-xmpp-server.h:
	* libinfinity/server/infd-xmpp-server.c: Build and Runtime fixes, use
	key.pem and cert.pem as key files for now. This should probably be
	replaced with a newly-created certificate later.

	* test/inf-test-xmpp-server.c: Added simple XMPP server test.

	* test/inf-test-xmpp-connection.c: Connect to local server instead of
	jabber.0x539.de.

	* test/key.pem:
	* test/cert.pem: Temporary example key files, copied from the GnuTLS
	distribution.

2007-04-08  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-xmpp-connection.c: Notify credentials and
	sasl-context properties when they are created.

	* libinfinity/server/infd-xmpp-server.h:
	* libinfintiy/server/infd-xmpp-server.c:
	* libinfinity/server/Makefile.am: Added XMPP server class,
	yet untested.

2007-03-29  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/server/infd-tcp-server.h:
	* libinfinity/server/infd-tcp-server.c: Added InfdTcpServer object.

	* libinfinity/server/infd-xml-server.h:
	* libinfinity/server/infd-xml-server.c: Added InfdXmlServer interface.

	* libinfinity/common/inf-tcp-connection.c: Added
	_inf_tcp_connection_accepted function, do not leak a socket if the
	connection attempt fails in inf_tcp_connection_open, do not chain up
	to finalize in dispose, do not leak the IO object, don't rely on errno
	keeping its value at the end of the recv/send loop.

	* test/inf-test-tcp-server.c:
	* test/Makefile.am: Added test for the TCP server.

2007-03-28  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-xmpp-connection.c: Fixed some bugs, client
	part mostly works.

	* libinfinity/common/inf-tcp-connection.c: Exit receiving/sending loop
	if the connection has been closed in a received/sent signal handler.

	* libinfinity/common/inf-xml-connection.c: Initialize interface only
	once.

	* test/inf-test-xmpp-connection.c:
	* test/Makefile.am: Added XMPP client test.

2007-03-28  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/: Moved all libinfinity sources and headers
	except inf-config.h and inf-marshal.h into a subdirectory.

	* libinfinity/server/: Moved all libinfinited files into another
	subdirectory.

	* libinfinited/: Removed.

	* libinfinity/common/Makefile.am:
	* libinfinity/server/Makefile.am:
	* libinfinity/Makefile.am:
	* configure.ac: Adjusted build for new directory structure.

2070-03-27  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-xmpp-connection.h:
	* libinfinity/inf-xmpp-connection.c: Added XMPP client and server
	implementation, yet untested.

	* libinfinity/inf-xml-stream.h:
	* libinfinity/inf-xml-stream.c: Removed, this is no longer used and
	replaced by XMPP.

	* configure.in:
	* libinfinity/Makefile.am: Depend on gnutls and libgsasl.

2007-03-19  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-marshal.in: Added VOID:POINTER,UINT marshaller.

	* libinfinity/inf-standalone-io.h:
	* libinfinity/inf-standalone-io.c: Added simple InfIo implementation.

	* libinfinity/inf-tcp-connection.h:
	* libinfinity/inf-tcp-connection.c: Implemented a TCP connection
	object.

	* libinfinity/Makefile.am: Added InfIoStandalone and InfTcpConnection
	to build.

	* test/inf-test-stream.xml:
	* test/inf-test-xml-stream.c: Removed those since InfXmlStream will
	probably be removed too, or at least change semantics.

	* test/inf-test-tcp-connection.c:
	* test/Makefile.am: Added simple TCP connection test.

2007-03-18  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-ip-address.h:
	* libinfinity/inf-ip-address.c:
	* Makefile.am: Boxed type managing an IP address.

2007-03-18  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-discovery-info.h:
	* libinfinity/inf-discovery.h:
	* libinfinity/inf-discovery-info.c:
	* libinfinity/inf-discovery.c:
	* Makefile.am: Added InfDiscovery and InfDiscoveryInfo interfaces.

2007-03-17  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-io.h:
	* libinfinity/inf-io.c:
	* Makefile.am: Added InfIo interface.

2007-03-15  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-xml-connection.h: 
	* libinfinity/inf-xml-connection.c: Added an InfXmlConnection
	interface that replaces GNetworkConnection.

	* libinfinity/inf-buffer.c:
	* libinfinity/inf-buffer.h: Made a property out of the read-only
	functions and signal.

	* libinfinity/inf-marshal.in: Replaced VOID:BOOLEAN by VOID:POINTER
	for InfXmlConnection.

	* libinfinity/inf-net-object.h:
	* libinfinity/inf-connection-manager.h:
	* libinfinity/inf-session.h:
	* libinfinited/infd-note-plugin.h:
	* libinfinited/infd-session.h:
	* libinfinited/infd-directory.h:
	* libinfinity/inf-net-object.c:
	* libinfinity/inf-connection-manager.c:
	* libinfinity/inf-session.c:
	* libinfinited/infd-session.c:
	* libinfinited/infd-directory.c: Adjusted to use InfXmlConnection
	instead of GNetworkConnection.

	* configure.ac:
	* libinfinity/Makefile.am:
	* libinfinited/Makefile.am: Dropped dependency on libgnetwork. Also
	excluded infd-server.[hc] from build because they would still require
	GNetworkServer. Another interface in libinfinited is required here.

2007-03-15  Armin Burgmeier  <armin@arbur.net>

	* libinfinited/infd-storage.h:
	* libinfinited/infd-storage.c: Turned the path field of
	InfdStorageNode to name.

	* libinfinited/infd-directory.h:
	* libinfinited/infd-directory.c: Implemented remaining functionality
	that was missing, some more enhanced operations like copying or moving
	nodes are still not supported, though.

2007-03-12  Armin Burgmeier  <armin@arbur.net>

	* libinfinited/infd-storage.h:
	* libinfinited/infd-storage.c: Renamed InfdDirectoryStorage to
	InfdStorage.

	* libinfinited/infd-note-plugin.h: Added interface for a note plugin.

	* libinfinited/infd-session.h:
	* libinfinited/infd-session.c:
	* libinfinined/Makefile.am: Implemented user joins.

2007-03-12  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-user.h:
	* libinfinity/inf-user.c: Removed connection field again. I don't
	think it is useful.

	* libinfinity/inf-session.h:
	* libinfinity/inf-session.c: Added
	inf_session_get_synchronization_status() and an exclude parameter to
	the validate_user_props vfunc.

	* libinfinity/inf-error.h:
	* libinfinity/inf-error.c:
	* libinfinity/Makefile.am: These specify some error codes that are
	commonly used by client and server.

2007-03-08  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-session.c: Connect to notify::status to find out
	when a connection is closed.

2007-03-08  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-session.h:
	* libinfinity/inf-session.c: Provide getters for connection manager
	and buffer. Also do a ref on the connection we get in
	inf_session_synchronize_to() because it will be unrefed when the
	synchronization is complete or failed.

2007-03-08  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-session.c: Before removing the session from the
	connection manager in inf_session_release_connection(), make sure that
	the connection manager still has the connection. If the connection was
	closed, the connection manager might have dropped the connection
	earlier.

	* libinfinity/inf-connection-manager.c: Refcount netobject
	registrations, but make sure objects are added with the same
	identifier.

2007-03-08  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-user.h:
	* libinfinity/inf-user.c: Added a connection field to InfUser
	specifiying a (not necessarily direct) connection between the local
	host and that user.

2007-03-07  Armin Burgmeier  <armin@arbur.net>

	* docs/plugin: Added notes about the plugin interface. It is not yet
	implemented, these are my just ideas how it should work, so I do not
	forget and could be expanded to a complete specification later.

2007-03-06  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-marshal.in: Added VOID:OBJECT,DOUBLE and
	VOID:OBJECT,POINTER marshallers for synchronization signals.

	* libinfinity/inf-net-object.h:
	* libinfinity/inf-net-object.c:
	* libinfinity/inf-connection-manager.h:
	* libinfinity/inf-connection-manager.c: Implemented separation between
	inner and outer queue, added enqueued vfunc in InfNetObject.

	* libinfinity/inf-session.h:
	* libinfinity/inf-session.c: Implemented session synchronization.

	* libinfinity/inf-buffer.c: Minor build fixes.

	* libinfinity/docs/terminology: Added inner queue and outer queue of
	connection manager.

	* libinfinity/docs/session: Applied slight changes that came up during
	implementation.

2007-03-01  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/docs:
	* libinfinity/docs/terminology:
	* libinfinity/docs/session: Added some notes, mostly for me to not
	forget how things are supposed to work, but perhaps also interesting
	to others.

2007-03-01  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-marshal.in: Added VOID:BOOLEAN marshaller.

	* libinfinity/inf-buffer.h:
	* libinfinity/inf-buffer.c:
	* libinfinity/Makefile.am: Added common buffer interface.

	* libinfinity/inf-text-buffer.c:
	* libinfinity/inf-ink-buffer.c: Changed prerequiste from GObject to
	InfBuffer.

2007-02-27  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/infd-directory.h:
	* libinfinity/infd-directory.c: Added some directory API, but most
	implementations are still missing.

2007-02-27  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-marshal.in: Added marshallers required for
	InfTextBuffer.

	* libinfinity/inf-text-buffer.h:
	* libinfinity/inf-text-buffer.c:
	* libinfinity/Makefile.am: Added InfTextBuffer interface.

	* libinfinited/inf-directory-storage.h:
	* libinfinited/inf-directory-storage.c: Added methods to read text
	notes, write ink and text notes, create a subdirectory and
	remove nodes.

2007-02-26  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-connection-manager.h:
	* libinfinity/inf-connection-manager.c: Added
	inf_connection_manager_has_connection(). Also do strong refs instead
	of weak refs on added net object. This way, net objects are kept alive
	if there are still connections open. Especially, this should allow
	keeping sessions alive even if the document in the directory tree is
	removed.

	* libinfinited/infd-server.h:
	* libinfinited/infd-server.c:
	* libinfinited/Makefile.am: New server class managing acception of
	incoming connections and (yet to come) service publishing.

	* libinfinited/infd-directory.h:
	* libinfinited/infd-directory.c: Implemented directory tree structure,
	but accessing background storage and handling client requests still
	missing.

2007-02-26  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-marshal.in: Added VOID:OBJECT marshaller.

	* libinfinity/inf-user.h:
	* libinfinity/inf-user.c:
	* libinfinity/inf-session.h:
	* libinfinity/inf-session.c:
	* Makefile.am: Added InfUser and InfSession classes.

	* libinfinity/inf-ink-buffer.c: Changed signal flags for the
	remove-stroke signal from G_SIGNAL_RUN_CLEANUP to G_SIGNAL_RUN_LAST
	and surrounded the signal emission by a g_object_ref / g_object_unref
	pair. This way, the stroke should stay alive after having been removed
	from the buffer and signal handlers running after the default handler
	don't get corrupted memory.

2007-02-23  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-ink-stroke.h:
	* libinfinity/inf-ink-stroke.c: Renamed from InfStroke to
	InfInkStroke.

	* libinfinity/inf-ink-buffer.h:
	* libinfinity/inf-ink-buffer.c: Made an interface out of InfBuffer,
	renamed to InfInkBuffer.

	* libinfinity/Makefile.am: Adjusted build rules for renamed files.

	* libinfinited/infd-directory-storage.h:
	* libinfinited/infd-directory-storage.c: Include inf-ink-buffer.h
	instead of inf-buffer.h, added text node type for upcoming
	collaborative text editing support, removed empty flag from node
	(client should query a node to check whether it is empty, this way it
	can also treat it as empty if it only contains nodes it is not
	interested in, for example a subdirectory containing only ink nodes
	will be shown empty in a text editor).

2007-02-21  Armin Burgmeier  <armin@arbur.net>

	* libinfinited/infd-directory.h:
	* libinfinited/infd-directory.c: Added GNetworkTcpServer object, close
	on error.

2007-02-21  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-connection-manager.c: Take a reference of the
	connection in inf_connection_manager_add_connection().

	* libinfinited/infd-directory.c:
	* libinfinited/infd-directory-storage.c:
	* libinfinited/infd-directory.h:
	* libinfinited/infd-directory-storage.h:
	* libinfinited/infd-marshal.in:
	* libinfinited/Makefile.am: Added interface for directory storage in
	libinfinited and initial directory class.

	* Makefile.am:
	* configure.ac: Build libinfinited.

2007-02-21  Armin Burgmeier  <armin@arbur.net>

	* libinfinity: Renamed infinity directory to libinfinity.

	* configure.ac:
	* Makefile.am:
	* test/Makefile.am:
	* test/inf-test-xml-stream.c:
	* libinfinity/*.[ch]: Changed references and includes from infinity to
	libinfinity. Also implemented inf_stroke_new_at().

2007-02-21  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-net-object.c: Add G_TYPE_OBJECT prerequisite.

2007-02-20  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-connection-manager.c:
	* infinity/inf-xml-stream.c: Chain up in destructor.

	* infinity/inf-buffer.h:
	* infinity/inf-buffer.c: Added InfBuffer class managing multiple
	InfStrokes.

	* infinity/inf-marshal.in: Added input file for glib-genmarshal.

	* infinity/Makefile.am: Create inf-marshal.h and inf-marshal.c from
	inf-marshal.in. Also added inf-buffer.c to build.

2007-02-20  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-stroke.h:
	* infinity/inf-stroke.c: Added position to InfStroke to which
	the coordinates of the contained InfStrokePoints are relative.

2007-02-20  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-xml-stream.c:
	* infinity/inf-connection-manager.c: Documentation fixes.

	* infinity/inf-net-object.c: Removed return in inf_net_object_sent()
	and inf_net_object_received() because these functions are void.

	* infinity/inf-stroke.h:
	* infinity/inf-stroke.c: Added object representing a single stroke.

	* infinity/Makefile.am: Added inf-stroke.c to build.

2007-02-19  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-connection-manager.h:
	* infinity/inf-connection-manager.c: Implemented message processing
	and inf_connection_manager_send_to_object().

2007-02-19  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-xml-stream.c:
	* infinity/inf-xml-stream.h:
	* infinity/Makefile.am: Added InfXmlStream class.

	* test/inf-test-xml-stream.c:
	* test/inf-test-stream.xml:
	* test/Makefile.am: Simple test routine to test functionality of
	InfXmlStream.

	* configure.ac: Create test/Makefile.
	* Makefile.am: Added test to SUBDIRS.

2007-02-18  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-connection-manager.c:
	* infinity/inf-connection-manager.h: Added InfConnectionManager class,
	not yet fully implemented, but compilable.

	* infinity/Makefile.am: Added inf-connection-manager.[ch].

2007-02-18  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-net-object.h:
	* infinity/inf-net-object.c: Renamed inf-netobject.[ch] to
	inf-net-object.[ch].

2007-02-18  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-netobject.h: Replaced INF_NET_OBJECT_TYPE by
	INF_TYPE_NET_OBJECT to follow gobject naming conventions.

2007-02-18  Armin Burgmeier  <armin@arbur.net>

	* configure.ac: Added check for glib, gobject, libgnetwork and
	libxml2.

	* infinity/Makefile.am: Add CFLAGS and libs of dependencies to
	libinfinity_1_0_la_CPPFLAGS respectively libinfinity_1_0_la_LIBADD.

	* infinity/inf-netobject.h: Added libgnetwork/gnetwork-connection.h
	and libxml/tree.h includes to make it actually compile.

	* infinity/inf-config.h.in: Removed generated file from repository.

2007-02-16  Armin Burgmeier  <armin@arbur.net>

	* configure.ac:
	* Makefile.am:
	* AUTHORS:
	* NEWS:
	* README:
	* COPYING:
	* INSTALL:
	* infinity/Makefile.am:
	* infinity/inf-config.h.in:
	* infinity/inf-netobject.h:
	* infinity/inf-netobject.c: Initial revision.
