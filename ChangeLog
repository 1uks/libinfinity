2008-02-22  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/server/infd-directory.c: Handle <save-session> request,
	automatically store idle sessions into storage, unload from RAM.

	* libinfinity/server/infd-session-proxy.h:
	* libinfinity/server/infd-session-proxy.c: Added the "idle" property,
	the "add-subscription" and "remove-subscription" signals and
	infd_session_proxy_has_subscriptions(),
	infd_session_proxy_is_subscribed() and infd_session_proxy_is_idle().

	* libinfinity/common/inf-error.h:
	* libinfinity/common/inf-error.c: Added
	INF_DIRECTORY_ERROR_UNSUBSCRIBED.

	* infinoted/note-plugins/text/infd-note-plugin-text.c: Fix a bug (an
	error was reported when everything was OK) when loading user-modified
	text.

2008-02-22  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/adopted/inf-adopted-request-log.h:
	* libinfinity/adopted/inf-adopted-request-log.c: Changed
	inf_adopted_request_log_upper_related() to take the request index
	instead of the request itself.

	* libinfinity/common/inf-method-manager.h:
	* libinfinity/common/inf-user-table.h:
	* libinfinity/adopted/inf-adopted-session.h: Removed superflous
	#defines, resulting from cut'n'pasted code.

	* libinfinity/adopted/inf-adopted-algorithm.c: Implemented caching for
	translated requests. This speeds up translation of undo requests that
	need to be transformed against several requests of others. This breaks
	test #25. However, the problem seems not to be with the cache but with
	the transformation function. I need to investigate this separately.
	Also simplified cleanup of request logs.

	* libinfinity/common/inf-buffer.c:
	* libinfinity/common/inf-session.c:
	* libinfinity/adopted/inf-adopted-user.c:
	* libinfinity/server/infd-directory.c:
	* docs/reference/libinfinity/libinfinity-sections.txt: Documentation
	fixes.

	* test/inf-test-text-session.c: Don't interpret given random seed as
	test directory.

	* test/std/test-47.xml: Added new test transforming ten undo requests
	against ten requests from another user. This is unacceptably slow
	without the request cache mentioned above.

2008-02-17  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/adopted/inf-adopted-split-operation.c:
	* libinfinity/common/inf-ip-address.c: More documentation.

2008-02-17  Benjamin Herr <ben@0x539.de>

	* libinfinity/common/inf-discovery.c
	* libinfinity/common/inf-session.c

	Added some more completely made-up documentation!

2008-02-17  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-io.h:
	* libinfinity/common/inf-io.c:
	* libinfinity/server/infd-directory.c:
	* libinfinity/common/inf-net-object.c:
	* libinfinity/common/inf-connection-manager.c:
	* libinfinity/client/infc-request.c: Documented these classes.

	* docs/reference/libinfinity/libinfinity.types: Committed types file
	as it seems to be required to generate correct documentation.

	* docs/reference/libinfinity/libinfinity-sections.txt: Order a bit.

2008-02-17  Benjamin Herr <ben@0x539.de>

	* libinfinity/common/inf-user-table.c:
	* libinfinity/common/inf-tcp-connection.c::
	* libinfinity/common/inf-xml-connection.c:

	Added preliminary documentation to a few signals.


2008-02-17  Benjamin Herr <ben@0x539.de>

	* libinfinity/adopted/inf-adopted-no-operation.c:
	* libinfinity/adopted/inf-adopted-split-operation.c:
	* libinfinity/server/infd-storage.c:
	* libinfinity/server/infd-storage.h:
	* libinfinity/common/inf-net-object.c:
	* libinfinity/common/inf-standalone-io.c:
	* libinfinity/common/inf-user-table.c:
	* libinfinity/common/inf-method-manager.c:
	* libinfinity/common/inf-ip-address.c:
	* libinfinity/common/inf-xmpp-manager.c:
	* libinfinity/common/inf-connection-manager.c:
	* libinfinity/common/inf-session.c:
	* libinfinity/client/infc-request-manager.c:
	* libinfinity/client/infc-request-manager.h:

	Solved minor documentation generation errors/warnings


2008-02-17  Armin Burgmeier  <armin@arbur.net>

	* docs/reference/libinfinity/tmpl/*.sgml: Committed SGML files
	required by gtk-doc.

2008-02-17  Benjamin Herr <ben@0x539.de>

	* **/*.c: changes "/** foo:\n *" into "/**\n * foo:"

2008-02-17  Armin Burgmeier  <armin@arbur.net>

	* autogen.sh: Added autogen.sh which also calls gtkdocize in addition
	to creating all the necessary build files.

	* configure.ac: Added gtk-doc support.
	* Makefile.am: Added docs to subdirs.

	* libinfinity/adopted/inf-adopted-state-vector.h:
	* libinfinity/adopted/inf-adopted-state-vector.c:
	* libinfinity/client/infc-browser-iter.c:
	* libinfinity/client/infc-browser.h:
	* libinfinity/client/infc-browser.c: Documentation fixes.

	* m4: Added m4 directory as required by some new configure macro.

	* docs/Makefile.am:
	* docs/reference/Makefile.am:
	* docs/reference/libinfinity/Makefile.am:
	* docs/reference/version.xml.in:
	* docs/reference/libinfinity/libinfinity-sections.txt:
	* docs/reference/libinfinity/libinfinity-docs.sgml:
	* docs/reference/libinfinity/libinfinity-overrides.txt: Added initial
	gtk-doc files to create documentation. Perhaps some more are required
	which I will commit when someone misses them. I just don't want to
	check in generated files.

	* test/inf-test-text-session.c: Reduced permutations to 100 so that it
	finishes earlier.

2008-02-15  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/adopted/inf-adopted-request-log.c: Fixed possible memory
	corruption when entries need to be reallocated.

	* TODO: Update.

2008-02-15  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/adopted/inf-adopted-algorithm.c: Replaced user_id ->
	requset log hash table by a user array, hopefully making some loops
	faster.

2008-02-15  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/adopted/inf-adopted-algorithm.h:
	* libinfinity/adopted/inf-adopted-algorithm.c: Read participating
	users directly from user table, remove
	inf_adopted_algorithm_add_user().

	* libinfinity/adopted/inf-adopted-session.c: Adapt to API change.

2008-02-15  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/adopted/inf-adopted-algorithm.c: Split the
	transformation part of inf_adopted_algorithm_translate_request() into
	a separate function inf_adopted_algorithm_transform_request().

2008-02-14  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/adopted/inf-adopted-algorithm.c: Fixed a bug introduced
	with the last commit that broke collaboration.

2008-02-14  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-user-table.h:
	* libinfinity/common/inf-user-table.c: Added add-local-user and
	remove-local-user signals, and inf_user_table_foreach_local_user().

	* libinfinity/server/infd-note-plugin.h:
	* libinfinity/server/infd-directory.c: Changed note plugin API so that
	read_session() creates the session instead of filling an existing
	session object.

	* infinoted/note-plugins/text/infd-note-plugin-text.c: Adapt.

	* libinfinity/client/infc-session-proxy.c: Removed some commented-out
	code.

	* libinfinity/adopted/inf-adopted-request.h:
	* libinfinity/adopted/inf-adopted-request.c: Added
	inf_adopte_request_affects_buffer().

	* libinfinity/adopted/inf-adopted-algorithm.c: Don't increase vector
	time of an incoming request's user if the request does not affect the
	buffer.

	* libinfinity/adopted/inf-adopted-session.c: Don't increase the last
	send vector if the sent request does not affect the buffer.

	* libinftext/inf-text-session.c: Broadcast cursor positions and
	selections.

	* libinftextgtk/inf-text-gtk-buffer.c: Update active user's cursor
	position when the "insert" or "selection-bound" mark is moved in the
	buffer.

2008-02-11  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/adopted/inf-adopted-algorithm.h:
	* libinfinity/adopted/inf-adopted-algorithm.c: Added
	inf_adopted_algorithm_can_undo() and inf_adopted_algorithm_can_redo()
	and the apply-request signal.

	* libinfinity/adopted/inf-adopted-session.h:
	* libinfinity/adopted/inf-adopted-session.c: Added
	inf_adopted_session_undo() and inf_adopted_session_redo().

	* libinftext/inf-text-session.c: Don't broadcast while the algorithm
	itself is applying a request.

	* test/inf-test-gtk-browser.c: Added GUI for undo/redo.

2008-02-11  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/adopted/inf-adopted-session.c: Send undo and redo
	operations as child of the <request> element instead of as an
	attribute of it. This is how the receiving code expects it.

2008-02-10  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-connection-manager.h:
	* libinfinity/common/inf-connection-manager.c: Rewrite connection
	manager to allow different publishers for groups with the same name,
	as in the spec. Also support dynamic loading of additional
	communication methods.

	* libinfinity/common/Makefile.am
	* libinfinity/common/inf-method-manager.h:
	* libinfinity/common/inf-method-manager.c: New InfMethodManager class
	to manage available communication methods.

	* libinfinity/Makefile.am
	* libinfinity/methods/Makefile.am:
	* libinfinity/methods/local-central/Makefile.am:
	* libinfinity/methods/local-central/inf-method-local-central.c: Simple
	"central" method for local networks that uses the publisher as server
	through which all messages are relayed.

	* libinfinity/common/inf-error.h:
	* libinfinity/common/inf-net-object.h:
	* libinfinity/common/inf-session.h:
	* libinfinity/common/inf-user.h:
	* libinfinity/common/inf-error.c:
	* libinfinity/common/inf-net-object.c:
	* libinfinity/common/inf-session.c:
	* libinfinity/common/inf-user.c:
	* libinfinity/common/inf-xml-connection.c:
	* libinfinity/common/inf-xmpp-connection.c:
	* libinfinity/adopted/inf-adopted-session.c:
	* libinfinity/adopted/inf-adopted-split-operation.c:
	* libinfinity/server/infd-directory.h:
	* libinfinity/server/infd-directory.c:
	* libinfinity/server/infd-server-pool.c:
	* libinfinity/server/infd-session-proxy.c:
	* libinfinity/client/infc-browser.h:
	* libinfinity/client/infc-browser.c:
	* libinfinity/client/infc-session-proxy.c:

	* test/inf-test-browser.c:
	* test/inf-test-daemon.c:
	* test/inf-test-text-session.c:
	* test/inf-test-gtk-browser.c:

	* libinfgtk/inf-gtk-browser-model.h:
	* libinfgtk/inf-gtk-browser-model.c:
	* libinftext/inf-text-session.c:
	* infinoted/infinoted-main.c: Adapt to API changes.

	* configure.ac: Generate Makefiles in newly added directories.

	* INSTALL: Autotools seemed to update this.

2007-12-22  Armin Burgmeier  <armin@arbur.net>

	* libinftext/inf-text-chunk.c: Fixed a crash on amd64.

	* infinoted/note-plugins/text/infd-note-plugin-text.c:
	* libinfinity/adopted/inf-adopted-session.c:
	* libinfinity/adopted/inf-adopted-split-operation.c:
	* libinfinity/common/inf-xmpp-manager.c:
	* libinfinity/common/inf-connection-manager.c:
	* libinfinity/common/inf-xmpp-connection.c:
	* libinftext/inf-text-default-insert-operation.c:
	* test/inf-test-chunk.c: Fixed several warnings.

2007-12-22  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-connection-manager.c: Changed scope for point
	to point connections from "p2p" to "ptp", as in the spec.

	* libinftextgtk/inf-text-gtk-buffer.c: Make sure only one user color
	tag is applied at once.

2007-12-22  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-error.c:
	* libinfinity/common/inf-error.h:
	* libinfinity/common/inf-session.c:
	* libinfinity/server/infd-session-proxy.c:
	* libinfinity/client/infc-session-proxy.c: Replaced user-leave by
	user-status-change request, which is more general.

	* libinfinity/server/infd-directory.c: Indentation fixes, fixed a
	memory leak in infd_directory_handle_explore_node().

	* libinftext/inf-text-session.c: Fixed an infinite loop when writing
	delete operations to XML.

	* infinoted/infinoted-creds.c: Include <glib.h> for glib 2.15
	compatibility.

2007-12-22  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/adopted/inf-adopted-session.c: Correctly pass for_sync
	to inf_adopted_session_xml_to_request() in
	inf_adopted_session_process_xml_sync(). This fixes editing documents
	with non-empty history.

	* libinfinity/adopted/inf-adopted-request-log.c: Adjust log begin when
	adding first entry to request log and that entry has non-zero vector
	time for the log's user.

	* libinfinity/adopted/inf-adopted-algorithm.c: Initialize new user's
	component of current vector time with the corresponding component of
	its vector time instead of the end of its request log because the
	request log might be empty.

	* infinoted/infinoted-main.c: Don't leak dirname in
	infinoted_main_create_dirname() in case of success.

2007-12-21  Armin Burgmeier  <armin@arbur.net>

	* libinftext/inf-text-chunk.c:
	* libinftext/inf-text-session.c: Swapped bytes/length arguments to
	inf_text_chunk_insert_text to fix handling of non-ASCII chars.

	* test/inf-test-chunk.c: Add an umlaut to the chunk to check UTF-8.

	* libinfinity/common/inf-session.c: Fixed signature of
	inf_session_connection_notify_status_cb().

	* TODO: Added a note about adding a connection-closed signal to
	connection manager.

2007-12-21  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-connection-manager.c: Forward scope="group"
	messages.

	* test/inf-test-gtk-browser.c: Retry user join with another name if
	the name is already in use, use algorithm's current vector time as
	initial time.

2007-12-04  Armin Burgmeier  <armin@arbur.net>

	* configure.ac:
	* README: Require gnutls >= 1.7.2 and gsasl >= 0.2.21.

2007-12-04  Armin Burgmeier  <armin@arbur.net>

	* configure.ac: Define INFINOTE_HAVE_AVAHI instead of HAVE_AVAHI to
	not conflict with other packages. We probably still need to get rid
	of autoheader to remove the default defines from inf-config.h.

	* libinfinity/common/inf-discovery-avahi.h:
	* libinfinity/common/inf-discovery-avahi.c:
	* infinoted/infinoted-main.c:
	* test/inf-test-daemon.c:
	* test/inf-test-gtk-browser.c: Adjusted and fixed non-avahi build.

2007-12-02  Armin Burgmeier  <armin@arbur.net>

	* libinftextgtk-1.0.pc.in: Added missing file.

2007-12-02  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/adopted/inf-adopted-request-log.c:
	* libinfinity/adopted/inf-adopted-session.c: Allow arbitrary ID
	for first request.

	* libinfinity/common/inf-connection-manager.c: Re-lookup NetObject for
	every request in group message.

	* libinftextgtk/inf-text-gtk-buffer.c: Fixed
	inf_text_gtk_buffer_buffer_get_slice if region to slice ends before
	segment ends.

2007-10-21  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-user.c: Return flags instead of status in
	inf_user_get_flags.

	* libinfinity/common/inf-connection-manager.c: Flag all messages as
	point-to-point in inf_connection_manager_send_multiple_to(), instead
	of just the first one. Also copy _private the private field in
	inf_connection_manager_send_to_group() because xmlCopyNode does not
	already do this.

	* libinfinity/common/inf-session.c: Correctly initialize GValue with
	zeroes before calling g_value_init(), implemented status user
	property. Emit close signal in synchronization failed default handler.

	* libinfinity/adopted/inf-adopted-request-log.h:
	* libinfinity/adopted/inf-adopted-request-log.c: Don't take log_begin
	parameter in inf_adopted_request_log_new(), return NULL instead of
	crashing in inf_adopted_request_log_next_undo() and
	inf_adopted_request_log_next_redo() when there is no next undo or redo
	request, respectively.

	* libinfinity/adopted/inf-adopted-user.c: Adapt to API change in
	InfAdoptedRequestLog.

	* libinfinity/adopted/inf-adopted-session.c: Increase last send vector
	instead of request's vector in inf_adopted_session_request_to_xml()
	(as originally intended). Initialize user field when creating
	InfAdoptedSessionLocalUser. Removed log-begin user property as in the
	spec.

	* libinfinity/server/infd-session-proxy.c: Use INF_SESSION_GET_CLASS
	instead of INF_SESSION_CLASS in infd_session_proxy_handle_user_join,
	initialize GValues correctly.

	* libinfinity/client/infc-session-proxy.c: Correctly set flags on user
	(re)join, don't release session when when it is closed so it is still
	accessible.

	* libinftext/inf-text-user.c: Don't make the caret-position and
	selection-length properties construct only.

	* libinftext/inf-text-session.c: Deal with author_id=0 in
	inf_text_session_process_xml_sync().

	* libinftextgtk/inf-text-gtk-buffer.c: Fixed assertions in
	inf_text_gtk_buffer_set_active_user(), fixed potential endless loops
	in inf_text_gtk_buffer_iter_prev_author_toggle(),
	inf_text_gtk_buffer_iter_next_author_toggle() and
	inf_text_gtk_buffer_buffer_get_slice(), connect to text buffer's
	signals when the buffer property is set, stop emission in
	inf_text_gtk_buffer_delete_range_cb() and
	inf_text_gtk_buffer_insert_text_cb() on the correct object.

	* test/inf-test-gtk-browser.c: Set vector property for join request.

2007-10-17  Armin Burgmeier  <armin@arbur.net>

	* infinoted/infinoted-main.c: Added --port-number command line option
	and load/save diffie-hellman parameters to current directory. This is
	just temporary to ease testing for me, so I don't have to wait too
	long when I need to restart the server again.

	* infinoted/note-plugins/text/infd-note-plugin-text.c: Allow author of
	segments to be 0, adapt to infd_filesystem_storage_open() API change.

	* libinfinity/inf-marshal.in: Added VOID:BOXED,BOXED,OBJECT
	marshaller.

	* libinfinity/common/inf-connection-manager.c: Allow
	inf_net_object_received() to remove itself from the connection manager
	group through which the message was passed, don't print a warning if a
	message for a nonexistant group is received.

	* libinfinity/common/inf-session.c: Only unref connection manager
	group in inf_session_release_connection() when it is set.

	* libinfinity/server/infd-filesystem-storage.h:
	* libinfinity/server/infd-filesystem-storage.c: Added note type
	parameter to infd_filesystem_storage_open(), and address correctly the
	file on disk.

	* libinfinity/server/infd-session-proxy.c: Keep session when it is
	closed, release in disponse().

	* libinfinity/server/infd-directory.c: Correctly unref
	InfConnectionManagerGroup (can't be freed with g_free()) in
	infd_directory_node_add_note().

	* libinfinity/server/infd-server-pool.c: Release reference on
	InfdTcpServer in infd_server_pool_entry_publish_with().

	* libinfinity/client/infc-note-plugin.h: Added an IO parameter to
	session_new().

	* libinfinity/client/infc-browser.h:
	* libinfinity/client/infc-browser.c: Added
	infc_browser_iter_get_note_type(), infc_browser_iter_get_plugin() and
	renamed -infc_browser_subscribe_session() to
	infc_browser_iter_subscribe_session(). Also take an IO parameter in
	infc_browser_new().

	* libinfinity/client/infc-node-request.c: Register private struct in
	class_init.

	* libinftext/inf-text-session.c: Allow user to be NULL in text buffer
	signal handlers, swap code and domain in invocation of g_set_error in
	inf_text_session_process_xml_sync() which were the other way around.

	* libinfgtk/inf-gtk-browser-model.h:
	* libinfgtk/inf-gtk-browser-model.c: Take an IO parameter in
	inf_gtk_browser_model_new() for the browsers to create, added the
	set-browser signal in whose default handler the browser is associated
	with the InfGtkBrowserModelItem and signal handlers are registered.

	* libinfgtk/inf-gtk-browser-view.h:
	* libinfgtk/inf-gtk-browser-view.c: Use the new "set-browser" signal
	of the model to connect to browser's signals, subscribe to sessions
	when a non-subdirectory node is activated and a plugin present.

	* libinftextgtk/inf-text-gtk-buffer.h:
	* libinftextgtk/inf-text-gtk-buffer.c: Added
	inf_text_gtk_buffer_get_text_buffer(), fixed interface registration
	(implement INF_TEXT_TYPE_BUFFER, not INF_TEXT_GTK_TYPE_BUFFER which is
	not even an interface).

	* test/inf-test-gtk-browser.c: Added support for subscribing to
	text sessions.

	* test/inf-test-browser.c: Pass IO to InfcBrowser.

	* test/Makefile.am: Link inf-test-gtk-browser against InfText and
	InfTextGtk.

2007-10-16  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-session.h:
	* libinfinity/common/inf-session.c: Added the
	inf_session_get_synchronization_progress() and
	inf_session_get_status() functions.

	* libinfinity/server/infd-directory.c: Fixed a wrong assertion in
	infd_directory_node_link().

	* libinfinity/client/infc-node-request.c: Added the node-id property.

	* libinfinity/client/infc-browser.h:
	* libinfinity/client/infc-browser.c: Set node-id property on node
	requests, added the begin_subscribe and subscribe_session signals,
	added infc_node_iter_get_subscribe_request() and
	infc_browser_iter_from_node_request() functions.

	* libinfgtk/inf-gtk-browser-model.h:
	* libinfgtk/inf-gtk-browser-model.c: Made error column valid for inner
	nodes, store errors from explore and subscription requests (We should
	expand this for all node requests later).

	* libinfgtk/inf-gtk-browser-view.h:
	* libinfgtk/inf-gtk-browser-view.c: Show synchronization progress and
	errors from inner nodes.

2007-10-12  Armin Burgmeier  <armin@arbur.net>

	* libinftext/inf-text-session.c: Fixed cursor positioning of executing
	user after deleting text.

	* libinftextgtk/inf-text-gtk-buffer.h:
	* libinftextgtk/inf-text-gtk-buffer.c:
	* libinftextgtk/Makefile.am: Implemented the InfTextBuffer interface
	using a GtkTextBuffer.

	* Makefile.am:
	* configure.ac: Build libinftextgtk.

	* README: Update.

2007-10-11  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/server/infd-directory.h:
	* libinfinity/server/infd-directory.c: Added the "io" property and
	construction paramater.

	* libinfinity/server/infd-note-plugin.h: Take an InfIo in
	session_new().

	* test/inf-test-daemon.c: Adapt.

	* infinoted/infinoted-note-plugin.c: Ignore all but the platform's
	module suffix in infinoted_note_plugin_load_directory().

	* infinoted/infinoted-main.c: Load all plugins in
	${libdir}/infinoted/note-plugins/.

	* infinoted/note-plugins/text/infd-note-plugin-text.c:
	* infinoted/note-plugins/text/Makefile.am:
	* infinoted/note-plugins/Makefile.am:
	* infinoted/Makefile.am:
	* configure.ac: Added a text plugin that saves sessions into an XML
	tree, in a InfdFilesystemStorage.

2007-10-10  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/server/infd-directory.h:
	* libinfinity/server/infd-directory.c: Added
	infd_directory_lookup_plugin().

	* infinoted/infinoted-note-plugin.h:
	* infinoted/infinoted-note-plugin.c:
	* infinoted/Makefile.am: Added functions to load note plugins from a
	certain directory.

	* configure.ac: Make infinoted depend on gmodule-2.0.

2007-10-09  Armin Burgmeier  <armin@arbur.net>

	* infinoted/infinoted-creds.h:
	* infinoted/infinoted-creds.c:
	* infinoted/infinoted-main.c: Made the server actually working.

2007-10-08  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-tcp-connection.c: Don't ifdef out
	_inf_tcp_connection_accepted because libinfinity/server is always
	built.

	* libinfinity/server/infd-note-plugin.h: Renamed identifier to
	note_type add added a storage_type member.

	* libinfinity/server/infd-directory.c: Adapt, and check storage type
	in infd_directory_add_plugin.

	* libinfinity/server/infd-filesystem-storage.h:
	* libinfinity/server/infd-filesystem-storage.c: Added
	infd_filesystem_storage_open() function.

	* infinoted/infinoted-creds.h:
	* infinoted/infinoted-creds.c:
	* infinoted/infinoted-main.c:
	* infinoted/Makefile.am: Added code which yields the infinote
	standalone server one day. Currently it only does certificate
	handling.

	* Makefile.am:
	* configure.ac: Build infinoted.

2007-10-07  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-marshal.in: Added VOID:BOXED,OBJECT marshaller.

	* libinfinity/common/inf-io.c: Return the value returned by the
	implementation to the caller in inf_io_add_timeout(), instead of
	nothing.

	* libinfinity/common/inf-standalone-io.c: Fixed two bugs in timeout
	handling.

	* libinfinity/common/inf-tcp-connection.c: Added the device-index and
	device-name properties. These are only used in IPv6 to set the scope
	ID for link-local messaging.

	* libinfinity/common/inf-discovery.h:
	* libinfinity/common/inf-discovery.c: Make the get_service_name()
	returned a new string so the implementation does not have to cache the
	service name.

	* libinfinity/common/inf-xml-connection.h:
	* libinfinity/common/inf-xml-connection.c: Added an error signal and
	local-id and remote-id properties.

	* libinfinity/common/inf-xmpp-connection.h:
	* libinfinity/common/inf-xmpp-connection.c: Removed error signal
	because it is now provided by InfXmlConnection, override the local-id
	and remote-id properties by using the ip/port pair of the underlaying
	TCP connection. Allow gnutls to return with GNUTLS_E_AGAIN in
	gnutls_record_recv since it seems to sometimes call the pull function
	multiple times. Don't wait for terminating </stream:stream>, but just
	close the connection on failed TLS handshake.

	* libinfinity/common/inf-discovery-avahi.c: Adapt to interface change
	in InfDiscovery, include device name and protocol in service name
	output.

	* libinfinity/common/inf-local-publisher.c: Replaced g_return_if_fail
	by g_return_val_if_fail in function returning non-void.

	* libinfinity/common/inf-xmpp-manager.c: Unref objects retrieved via
	g_object_get(), connect to every connection's notify::status signal to
	remove the connection when it is closed.

	* libinfinity/common/inf-connection-manager.c: Remove the group from
	the list of groups in inf_connection_manager_group_free().

	* libinfinity/client/infc-browser.h:
	* libinfinity/client/infc-browser.c: Added an iterator pointing to the
	subdirectory being explored to the begin-explore signal. Don't clear
	directory tree when the connection is lost but rather when a new
	connection is set so we can still browse the explored paths when
	disconnected.

	* libinfinity/client/infc-explore-request.c: Replaced
	g_value_set_finished by g_value_set_boolean as it ought to be. I must
	have been asleep when having coded this.

	* libinfinity/server/infd-server-pool.c: Use username for service name
	when the real name is not known.

	* libinfgtk/inf-gtk-browser-model.h:
	* libinfgtk/inf-gtk-browser-model.c: Added the INVALID status, keep
	the item after disconnection so a potential error can still be
	displayed. Fixed several bugs.

	* libinfgtk/inf-gtk-browser-view.c: Propagate size_request and
	size_allocate. Implemented exploration and fixed several bugs.

	* libinfgtk/inf-gtk-io.h:
	* libinfgtk/inf-gtk-io.c:
	* libinfgtk/Makefile.am: Added a InfIo implementation using the
	default Glib mainloop.

	* test/inf-test-daemon.c: Publish the infinote service on avahi.

	* test/inf-test-gtk-browser.c:
	* test/Makefile.am: Added a test showing a InfGtkBrowserView to browse
	avahi-discovered infinote servers.

2007-10-04  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-marshal.in: Added VOID:OBJECT,OBJECT marshaller.

	* libinfinity/common/inf-discovery.c: Fixed return statements in
	functions returning non-void.

	* libinfinity/client/infc-browser.h:
	* libinfinity/client/infc-browser.c: Added the
	infc_browser_iter_is_subdirectory() function.

	* libinfinity/client/infc-explore-request.h:
	* libinfinity/client/infc-explore-request.c: Added the
	infc_explore_request_get_initiated() and
	infc_explore_request_get_finished() functions.

	* libinfgtk/inf-gtk-browser-model.h:
	* libinfgtk/inf-gtk-browser-model.c: Take InfConnectionManager in
	constructor, added inf_gtk_browser_model_browser_iter_to_tree_iter()
	and the INF_GTK_BROWSER_MODEL_COL_DISCOVERY column. Fixed reordering
	when a resolve yielded an already existing connection.

	* libinfgtk/inf-gtk-browser-view.h:
	* libinfgtk/inf-gtk-browser-view.c:
	* libinfgtk/Makefile.am: Implemnted InfGtkBrowserView, a widget
	displaying a InfGtkBrowserModel. Some implementation bits (mostly
	exploration on expansion) are still missing.

2007-10-03  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/infc-browser.c: Removed a TODO comment that was
	already done by the last commit.

	* libinfgtk/inf-gtk-browser-model.h:
	* libinfgtk/inf-gtk-browser-model.c:
	* libinfgtk/Makefile.am: A container for multiple InfcBrowser and
	InfDiscovery objects that implements GtkTreeModel to be shown by a
	GtkTreeView.

	* Makefile.am: Changed order of SUBDIRS so that always the library
	directories are walked first, and then pixmaps/ and test/.

	* configure.ac: Cleaned up final status output. I still don't know why
	it sometimes appears above the "config.status: Creating Foo/Makfile"
	output.

2007-10-03  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/client/infc-browser.h:
	* libinfinity/client/infc-browser.c: Added
	infc_browser_iter_get_explore_request(),
	infc_browser_iter_from_explore_request() and the begin-explore signal.

	* pixmaps/16x16/infinote.png:
	* pixmaps/16x16/Makefile.am:
	* pixmaps/22x22/infinote.png:
	* pixmaps/22x22/Makefile.am: Added bitmap icons for small sizes.

	* pixmaps/scalable/infinote.svg:
	* pixmaps/scalable/Makefile.am: Moved from pixmaps/infinote.svg

	* pixmaps/Makefile.am:
	* configure.ac: Process pixmaps/16x16, pixmaps/22x22 and
	pixmaps/scalable.

2007-10-02  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-discovery-info.h:
	* libinfinity/common/inf-discovery-info.c: Removed, the functioality
	is incorporated into InfDiscovery.

	* libinfinity/common/inf-local-publisher.h:
	* libinfinity/common/inf-local-publisher.c:
	* libinfinity/common/Makefile.am: A new interface that is
	implemented by objects that can publish services on the local network.

	* libinfinity/common/inf-discovery.h:
	* libinfinity/common/inf-discovery.c: Removed the publish vfunc in
	favour of InfLocalPublisher. Added info_get_service_name and
	info_get_service_type vfuncs.

	* libinfinity/common/inf-discovery-avahi.h:
	* libinfinity/common/inf-discovery-avahi.c: Class that implements
	InfDiscovery and InfLocalPublisher by using Avahi.

	* libinfinity/server/infd-server-pool.h:
	* libinfinity/server/infd-server-pool.c: Added functionality to
	associate local publishers with servers and automatically publish
	service when the corresponding server is up.

	* libinfinity/Makefile.am: Build with and link against avahi.

2007-09-27  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-xmpp-connection.c: Set xmpp connection as
	gsasl session hook so that callback implementations can access the
	InfXmppConnection object.

2007-09-27  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-xmpp-connection.h: Fix indentation.

	* libinfinity/common/inf-xmpp-connection.c: Added a TODO about
	retrieving the server's (or other entity's) JID.

	* libinfinity/common/inf-tcp-connection.h:
	* libinfinity/common/inf-tcp-connection.c: Added
	inf_tcp_connection_get_remote_address() and
	inf_tcp_connection_get_remote_port().

	* libinfinity/common/inf-discovery.h:
	* libinfinity/common/inf-discovery.c: Added the get_discovered vfunc
	and inf_discovery_get_discovered().

	* libinfinity/common/inf-xmpp-manager.h:
	* libinfinity/common/inf-xmpp-manager.c:
	* libinfinity/common/Makefile.am: Added the InfXmppManager class that
	manages XMPP connections and provides lookup by IP address and port so
	that existing connections can be reused.

	* libinfinity/server/infd-storage.h: Added a TODO comment about
	possible notification when stored items change.

	* libinfgtk/Makefile.am:
	* libinfgtk-1.0.pc.in:
	* Makefile.am:
	* configure.ac: Added libinfgtk component, but there are not yet any
	source files.

2007-09-25  Armin Burgmeier  <armin@arbur.net>

	* pixmaps/infinote.svg: Moved from artwork/infinote.svg to
	pixmaps/infinote.svg.

	* pixmaps/Makefile.am: Install the icon into
	$(datadir)/hicolor/scalable/apps. I am not sure whether this in the
	correct location, though.

	* libinfinity-1.0.pc.in:
	* libinftext-1.0.pc.in:
	* Makefile.am: Added pkgconfig files, added pixmaps subdir.

	* configure.ac: Added new files to output.

	* TODO: Added gettext support to TODO list.

2007-09-25  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-net-object.c: Allow connection to be NULL in
	inf_net_object_received for now, so the session test can simulate
	incoming XML.

	* libinfinity/common/inf-user-table.c: Fixed two typos.

	* libinfinity/common/inf-buffer.c: Removed read-only property. We
	might re-introduce an editable property later.

	* libinfinity/common/inf-session.c: Cope with NULL group and sync
	connection in inf_session_set_property().

	* libinfinity/adopted/inf-adopted-request-log.c: Return NULL in
	inf_adopted_request_log_find_associated() when there is no Undo
	request associated to a redo request, instead of running in a failed
	assertion. This is a completely legal case for caching next_undo and
	next_redo operations.

	* libinfinity/adopted/inf-adopted-user.c: Cope with NULL request log
	in inf_adopted_user_set_property(), don't copy result in
	inf_adopted_user_get_vector().

	* libinfinity/adopted/inf-adopted-state-vector.c: Fixed a crash in
	inf_adopted_state_vector_causally_before() when the highest key
	in the first vector was not contained in the second. Also fixed a typo
	leading to a crash in inf_adotped_state_vector_from_string_diff().

	* libinfinity/adopted/inf-adopted-session.c: Include current request
	in last send vector after having sent the request. Otherwise, we are
	sending an unnecessary, additional "$id:1" component for each
	following request. Recognize undo requests by <undo /> child instead
	of type="undo" attribute, as in the protocol specification. Keep
	users in the user table in-sync with those in InfAdoptedAlgorithm.
	Don't leak the request in inf_adopted_session_Process_xml_run().

	* libinfinity/adopted/inf-adopted-algorithm.c: Update user vector
	after having received a request, not only when having processed it.
	When transforming two operations in the request log, first transform
	both to the least common successor and then transform both from that
	point to the final destination. This way, pwords of insert operations
	are updated correctly. This could lead to a desync. Change the state
	of undo and redo requests to the same state of the original operation
	(except the issuing user's component) because they only depend on the
	original operation.

	* libinfinity/adopted/inf-adopted-split-operation.h:
	* libinfinity/adopted/inf-adopted-split-operation.c: Added the
	inf_adopted_split_operation_transform_other() function that transfors
	an operation against the split operation. Also don't leak the
	resulting operations in inf_adopted_split_operation_transform().

	* libinfinity/adopted/inf-adopted-operation.c: Use
	inf_adopted_split_operation_transform_other() in
	inf_adopted_operation_transform() when against is a
	InfAdoptedSplitOperation. Fix a copy'n'paste error in the
	interface's GTypeInfo struct.

	* libinftext/inf-text-move-operation.h:
	* libinftext/inf-text-move-operation.c: Renamed
	inf_text_move_operation_get_pword() to
	inf_text_move_operation_get_position() and
	inf_text_move_operation_get_chunk() to
	inf_text_move_operation_get_length(). This was also a copy'n'paste
	error by copying the file from libinftext/inf-text-insert-operation.c.

	* libinftext/inf-text-chunk.h:
	* libinftext/inf-text-chunk.c: Added a GString to each chunk that
	holds the chunk's content without author information for integrity
	checking (can be disabled by not defining CHUNK_DEBUG). Added
	the inf_text_chunk_equal() function. Fixed two errors when inserting a
	chunk into another chunk that broke the chunk's integrity.

	* libinftext/inf-text-buffer.h:
	* libinftext/inf-text-buffer.c: Reorded bytes and length parameters in
	inf_text_buffer_insert_text() to match the order of corresponding
	functions in libinftext. Allow the user parameter to be NULL in which
	case the text is inserted as author 0.

	* libinftext/inf-text-user.h:
	* libinftext/inf-text-user.c: Derive from InfAdoptedUser not from
	InfUser.

	* libinftext/inf-text-default-delete-operation.c: End g_object_new()
	invocation in inf_text_default_delete_operation_transform_split() with
	NULL so that g_object_new() does not start reading random memory.

	* libinftext/inf-text-default-insert-operation.c: Cast result to
	InfTextInsertOperation instead of InfAdoptedOperation in
	inf_text_default_insert_operation_transform_position().

	* libinftext/inf-text-remote-delete-operation.c: Append final recon
	chunk to list in inf_text_remote_delete_operation_recon_feed(). Don't
	leak the InfTextChunk obtained by inf_text_buffer_get_slice() in
	inf_text_remote_delete_operation_make_reversible(). Don't leak the
	unsplit list in the same function. Feed recon to the resulting
	operation in inf_text_remote_delete_operation_transform_overlap(), not
	to the original operation.

	* libinftext/inf-text-default-buffer.c: Implement the InfBuffer
	interface.

	* libinftext/inf-text-pword.c: Swapped the result of
	inf_text_pword_compare() when the two pwords have different length to
	obtain the intended behaviour.

	* libinftext/inf-text-session.c: Pass correct text to g_convert() and
	xmlFree() in inf_text_session_xml_to_operation(). Don't forget final
	NULL in g_object_new() call in inf_text_session_new() and
	inf_text_session_new_with_user_table().

	* test/inf-test-chunk.c: Test some basic InfTextChunk operations.

	* test/inf-test-text-operations.c: Test C1 and C2 properties of the
	InfText operations.

	* test/inf-test-text-session.c: Test the implementation of the
	concurrency control algorithm implemented by InfAdoptedAlgorithm by
	reading test scenarios from XML files in std/.

	* test/Makefile.am: Added the new files

	* test/std/test-01.xml:
	* test/std/test-02.xml:
	* test/std/test-03.xml:
	* test/std/test-04.xml:
	* test/std/test-05.xml:
	* test/std/test-06.xml:
	* test/std/test-07.xml:
	* test/std/test-08.xml:
	* test/std/test-09.xml:
	* test/std/test-10.xml:
	* test/std/test-11.xml:
	* test/std/test-12.xml:
	* test/std/test-13.xml:
	* test/std/test-14.xml:
	* test/std/test-15.xml:
	* test/std/test-16.xml:
	* test/std/test-17.xml:
	* test/std/test-18.xml:
	* test/std/test-19.xml:
	* test/std/test-20.xml:
	* test/std/test-21.xml:
	* test/std/test-22.xml:
	* test/std/test-23.xml:
	* test/std/test-24.xml:
	* test/std/test-25.xml:
	* test/std/test-26.xml:
	* test/std/test-27.xml:
	* test/std/test-28.xml:
	* test/std/test-29.xml:
	* test/std/test-30.xml:
	* test/std/test-31.xml:
	* test/std/test-32.xml:
	* test/std/test-33.xml:
	* test/std/test-34.xml:
	* test/std/test-35.xml:
	* test/std/test-36.xml:
	* test/std/test-37.xml:
	* test/std/test-38.xml:
	* test/std/test-39.xml:
	* test/std/test-40.xml:
	* test/std/test-41.xml:
	* test/std/test-42.xml:
	* test/std/test-43.xml:
	* test/std/test-44.xml:
	* test/std/test-45.xml:
	* test/std/test-46.xml: Added 46 test files for
	inf-test-text-session.c.

2007-09-17  Armin Burgmeier  <armin@arbur.net>

	* libinftext/inf-text-operations.h: File to just forward declare
	InfTextInsertOperation and InfTextDeleteOperation because their
	headers both need the two to be declared.

	* libinftext/inf-text-session.h:
	* libinftext/inf-text-session.c: Implemented InfTextSession.

	* libinftext/Makefile.am: Added the new files to the build.

2007-09-17  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-xml-util.h:
	* libinfinity/common/inf-xml-util.c: Implemented
	inf_xml_util_set_attribute_int() and
	inf_xml_util_set_attribute_int_required().

	* libinfinity/adopted/inf-adopted-operation.h:
	* libinfinity/adopted/inf-adopted-operation.c: Added concurrency_id
	paramater to the transform vfunc.

	* libinfinity/adopted/inf-adopted-request.c:
	* libinfinity/adopted/inf-adopted-no-operation.c:
	* libinfinity/adopted/inf-adopted-split-operation.c: Adapt to the
	above API change.

	* libinfinity/adopted/inf-adopted-session.h:
	* libinfinity/adopted/inf-adopted-session.c: Added InfUser parameter
	to the xml_to_operation vfunc.

	* libinftext/inf-text-delete-operation.h:
	* libinftext/inf-text-insert-operation.h:
	* libinftext/inf-text-delete-operation.c:
	* libinftext/inf-text-insert-operation.c: Made interfaces out of
	these, implement transformation.

	* libinftext/inf-text-move-operation.h:
	* libinftext/inf-text-move-operation.c: Added
	inf_text_move_operation_transform_insert() and
	inf_text_move_operation_transform_delete().

	* libinftext/inf-text-buffer.h:
	* libinftext/inf-text-buffer.c:
	* libinftext/inf-text-default-buffer.c: Added the get_length vfunc.

	* libinftext/inf-text-default-insert-operation.h:
	* libinftext/inf-text-default-insert-operation.c:
	* libinftext/inf-text-default-delete-operation.c:
	* libinftext/inf-text-default-delete-operation.h:
	* libinftext/Makefile.am: Readded normal reversible insert and delete
	operations that were in inf-text-{insert,delete}-operation.[ch]
	before, and implement the new interface.

	* libinftext/inf-text-remote-delete-operation.h:
	* libinftext/inf-text-remote-delete-operation.c: Implement the
	InfTextDeleteOperation interface.

2007-09-15  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-marshal.in: Added VOID:UINT,INT marshaller.

	* libinftext/inf-text-user.h:
	* libinftext/inf-text-move-operation.h:
	* libinftext/inf-text-remote-delete-operation.h:
	* libinftext/inf-text-user.c:
	* libinftext/inf-text-move-operation.c:
	* libinftext/inf-text-remote-delete-operation.c:
	* libinftext/Makefile.am: Implement InfTextUser (storing cursor and
	selected text), InfTextMoveOperation (an operation that changes a
	user's selection and cursor position) and
	InfTextRemoteDeleteOperation (a delete operation that only saves
	position and length of the deleted text, but not the actual text that
	was deleted).

2007-09-14  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/adopted/inf-adopted-operation.h:
	* libinfinity/adopted/inf-adopted-operation.c:
	* libinfinity/adopted/inf-adopted-no-operation.c:
	* libinfinity/adopted/inf-adopted-split-operation.c: Removed the
	is_reversible vfunc and added it as an operation flag.

	* libinfinity/server/infd-session-proxy.c: Fixed message handling (the
	message is called user-join, not join-user).

	* libinftext/inf-text-pword.h:
	* libinftext/inf-text-insert-operation.h:
	* libinftext/inf-text-delete-operation.h:
	* libinftext/inf-text-pword.c:
	* libinftext/inf-text-insert-operation.c:
	* libinftext/inf-text-delete-operation.c:
	* libinftext/Makefile.am: Added the two bosic text operations.

	* TODO: Removed finished tasks, added new ones about making
	InfTextChunk reference-counted.

2007-09-10  Armin Burgmeier  <armin@arbur.net>

	* libinftext/inf-text-buffer.c: Fixed a marshaller.

	* libinftext/inf-text-default-buffer.h:
	* libinftext/inf-text-default-buffer.c:
	* libinftext/Makefile.am: Added a InfTextBuffer implementation using
	an underlaying InfTextChunk.

2007-09-10  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-user-table.h:
	* libinfinity/common/inf-user-table.c:
	* libinfinity/common/Makefile.am: Added user table class managing
	users and providing lookup by ID and name.

	* libinfinity/common/inf-session.h:
	* libinfinity/common/inf-session.c: Make use of InfUserTable instead
	of using an own hash table. Removed some API that is not provided by
	InfUserTable.

	* libinfinity/client/infc-session-proxy.c:
	* libinfinity/server/infd-session-proxy.c:
	* libinfinity/adopted/inf-adopted-session.c: Adjusted for API change
	introduced by the new user table.

	* libinfinity/inf-ink-buffer.h:
	* libinfinity/inf-ink-stroke.h:
	* libinfinity/inf-ink-buffer.c:
	* libinfinity/inf-ink-stroke.c: Removed from repository, InfInk will
	not be implemented in the short-term.

	* libinftext/inf-text-chunk.h:
	* libinftext/inf-text-chunk.c: Added InfTextChunkIter API to iterate
	over segments.

	* libinfinity/inf-marshal.in: Replaced POINTER,UINT,UINT,OBJET byC
	UINT,BOXED,OBJECT marshaller.

	* libinftext/inf-text-buffer.h:
	* libinftext/inf-text-buffer.c:
	* libinftext/Makefile.am: Added InfTextBuffer interface.

2007-09-10  Philipp Kern <phil@0x539.de>

	* configure.ac: some fixes

2007-09-09  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/adopted/inf-adopted-request-log.c: Added a TODO comment
	about possible memory corruption.

	* libinfinity/inf-text-buffer.h:
	* libinfinity/inf-text-buffer.c: Removed. InfTextBuffer will get
	resurrected in the inftext separate module.

	* libinftext/inf-text-chunk.h:
	* libinftext/inf-text-chunk.c:
	* libinftext/Makefile.am: Created inftext module with a first boxed
	type to store and operate on strings with author information.

	* Makefile.am:
	* configure.ac: Added libinftext to build.

2007-09-06  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/adopted/inf-adopted-state-vector.h:
	* libinfinity/adopted/inf-adopted-operation.h:
	* libinfinity/adopted/inf-adopted-request-log.h:
	* libinfinity/adopted/inf-adopted-request.h:
	* libinfinity/adopted/inf-adopted-algorithm.h:
	* libinfinity/adopted/inf-adopted-state-vector.c:
	* libinfinity/adopted/inf-adopted-operation.c:
	* libinfinity/adopted/inf-adopted-request-log.c:
	* libinfinity/adopted/inf-adopted-request.c:
	* libinfinity/adopted/inf-adopted-algorithm.c: Made these only have a
	user ID instead of a user object, so they can exist without actual
	user objects and InfAdoptedUser can have InfAdoptedRequestLog as
	property.

	* libinfinity/adopted/inf-adopted-user.h:
	* libinfinity/adopted/inf-adopted-user.c: Added the request-log
	property.

	* test/inf-test-state-vector.c: Adjusted for the change mentioned
	above.

	* libinfinity/adopted/inf-adopted-session.c:
	* libinfinity/adopted/inf-adopted-session.h:
	* libinfinity/adopted/Makefile.am: Added the InfAdoptedSession class,
	implementing the other half of the dark magic (although not-so-dark).
	Timeouts are not yet implemented.

	* libinfinity/common/inf-standalone-io.c: Fixed a compiler warning.

	* libinfinity/common/inf-xml-util.h: Fixed indentation.

	* libinfinity/common/inf-xml-util.c: Changed an error message so that
	it includes the (errornous) request's name.

	* libinfinity/common/inf-error.c: Added a TODO comment.

	* libinfinity/common/inf-session.h:
	* libinfinity/common/inf-session.c: Added an error parameter to
	the process_xml_run vfunc.

	* libinfinity/client/infc-session-proxy.c: Set subscription group in
	infc_session_proxy_set_connection().

	* TODO: Removed finished items, added the addition of a reversible
	flag for InfAdoptedOperation instead of an extra vfunc.

2007-09-02  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/server/infd-session.h:
	* libinfinity/server/infd-session.c:
	* libinfinity/client/infc-session.h:
	* libinfinity/client/infc-session.c: Removed.

	* libinfinity/common/inf-session.h:
	* libinfinity/common/inf-session.c: Added subscription group property.

	* libinfinity/server/infd-session-proxy.h:
	* libinfinity/server/infd-session-proxy.c:
	* libinfinity/client/infc-session-proxy.h:
	* libinfinity/client/infc-session-proxy.c: Added InfcSessionProxy and
	InfdSessionProxy classes. These basically have the same functionality
	as the old InfcSession and InfdSession but own them rather than
	inherit from them. This is needed because GObject does not allow
	multiple inheritance: Other types can now inherit from InfSession
	while InfcSessionProxy (or InfdSessionProxy, respectively) can still
	do their job.

	* libinfinity/server/infd-note-plugin.h:
	* libinfinity/server/infd-directory.h:
	* libinfinity/server/infd-directory.c:
	* libinfinity/server/Makefile.am:
	* libinfinity/client/infc-note-plugin.h:
	* libinfinity/client/infc-browser.h:
	* libinfinity/client/infc-browser.c:
	* libinfinity/client/Makefile.am: Adjusted accordingly.

	* TODO: Removed finished items

2007-09-01  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-connection-manager.h:
	* libinfinity/common/inf-connection-manager.c: Made
	InfConnectionManagerGroup a boxed type, allow changing a group's
	InfNetObject via inf_connection_manager_group_set_object().

	* TODO: Added plans about making InfcSession and InfdSession not
	inherit from InfSession.

2007-08-31  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-connection-manager.h:
	* libinfinity/common/inf-connection-manager.c: Redesigned connection
	manager. Now there are groups of which connections can be a member.

	* libinfinity/common/inf-session.h:
	* libinfinity/common/inf-session.c:
	* libinfinity/server/infd-session.h:
	* libinfinity/server/infd-session.c:
	* libinfinity/client/infc-session.h:
	* libinfinity/client/infc-session.c:
	* libinfinity/client/infc-browser.c:
	* libinfinity/server/infd-directory.c: Adjusted use.

	* TODO: Added another item about dropping the message table in
	InfcSession/InfdSession.

2007-08-27  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-io.h:
	* libinfinity/common/inf-io.c:
	* libinfinity/common/inf-standalone-io.c: Implemented addition and
	removal of timeouts for InfIo.

	* TODO: Noted down some basic TODO items that would be nice to have
	for a first release.

2007-08-26  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-marshal.in: Added VOID:OBJECT,BOOLEAN marshaller.

	* libinfinity/inf-text-chunk.c: Added a comment, and a TODO item.

	* libinfinity/adopted/inf-adopted-operation.h: Added another TODO
	item.

	* libinfinity/adopted/inf-adopted-request-log.h:
	* libinfinity/adopted/inf-adopted-request-log.c: Added the
	inf_adopted_request_log_next_undo(),
	inf_adopted_request_log_next_redo() and
	inf_adopted_request_log_upper_related() functions.

	* libinfinity/adopted/inf-adopted-algorithm.h:
	* libinfinity/adopted/inf-adopted-algorithm.c:
	* libinfinity/adopted/Makefile.am: Implemented the first part of the
	really dark magic.

2007-08-22  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/adopted/inf-adopted-request-log.c: Allow the given
	request to be one past the end of the log in which case it is treated
	as it was the newest in the log.

2007-08-22  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-text-chunk.h:
	* libinfinity/inf-text-chunk.c: Beginning of a InfTextChunk
	implementation, storing text written by specific users. This will
	probably later be moved into a separate InfText library. This code is
	partly written by Benjamin Herr <ben@0x539.de>.

2007-08-22  Benjamin Herr  <ben@0x539.de>

	* all source files: Appended vim modelines.

2007-08-20  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/adopted/inf-adopted-state-vector.h:
	* libinfinity/adopted/inf-adopted-state-vector.c: Added compare and
	causal relation functions.

	* libinfinity/adopted/inf-adopted-request.h:
	* libinfinity/adopted/inf-adopted-request.c: Made a GObject out of
	this and implement transfrom, mirror and fold operations.

	* libinfinity/adopted/inf-adopted-request-log.c: Added next-undo and
	next-redo properties and additional linking between the entries
	(original, next associated and previous associated request).

2007-08-18  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/adopted/inf-adopted-operation.h: Removed superfluous
	comma at end of enumeration.

	* libinfinity/adopted/inf-adopted-request.h:
	* libinfinity/adopted/inf-adopted-request-log.h:
	* libinfinity/adopted/inf-adopted-request.c:
	* libinfinity/adopted/inf-adopted-request-log.c: Implemnted
	InfAdoptedRequest and InfAdoptedRequestLog, though the latter is still
	missing can-undo/can-redo tracking.

	* libinfinity/adopted/Makefile.am: Build the new files.

2007-08-18  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-buffer.c: Set initialized to TRUE in
	inf_buffer_base_init so the interface is only initialized once.

	* libinfinity/common/inf-user.c: Correctly register user flags type as
	flags instead of as enum.

	* libinfinity/adopted/inf-adopted-state-vector.h:
	* libinfinity/adopted/inf-adopted-user.h:
	* libinfinity/adopted/inf-adopted-operation.h:
	* libinfinity/adopted/inf-adopted-split-operation.h:
	* libinfinity/adopted/inf-adopted-no-operation.h:
	* libinfinity/adopted/inf-adopted-state-vector.c:
	* libinfinity/adopted/inf-adopted-user.c:
	* libinfinity/adopted/inf-adopted-operation.c:
	* libinfinity/adopted/inf-adopted-split-operation.c:
	* libinfinity/adopted/inf-adopted-no-operation.c:
	* libinfinity/adopted/Makefile.am: Implemented some initial types for
	the yet-to-come adopted implementation.

	* libinfinity/Makefile.am:
	* configure.ac: Include libinfinity/adopted to build, generate
	libinfinity/adopted/Makefile.

	* test/inf-test-state-vector.c:
	* test/Makefile.am: Added simple state vector test.

2007-08-15  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-user.h:
	* libinfinity/common/inf-user.c: Added a flags property with user
	flags with INF_USER_LOCAL being the only user property so far.

	* libinfinity/client/infc-session.c:
	* libinfinity/server/infd-session.c: Set the INF_USER_LOCAL flag as
	appropriate.

	* README: Require glib-2.14 to be able to use GSequence.

2007-07-22  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/client/infc-browser.h:
	* libinfinity/client/infc-browser.c: Added
	infc_browser_iter_get_name().

	* libinfinity/common/inf-xmpp-connection.c: ref/unref the XMPP
	connection object around callback for sent messages because those
	callbacks might unref the XMPP connection.

	* libinfinity/common/inf-net-object.c: Don't require virtual functions
	to be implemented.

	* libinfinity/common/inf-xml-connection.c: Fixed signal emission of
	sent and received signal, wrong parameter was passed.

	* libinfinity/common/inf-connection-manager.c: Only send further
	messages if there are any, after previous messages have been sent out.

	* libinfinity/server/infd-filesystem-storage.c: Fixed path to file on
	disk which was wrong in infd_filesystem_storage_read_subdirectory().

	* libinfinity/server/infd-directory.c: Only call
	infd_directory_node_remove_connection() for explored subdirectory
	nodes because only those can have connections that have explored that
	node.

	* libinfinity/client/infc-request-manager.c: Don't unref the request
	when removing from the hash table because the hash table already does
	it via its value_destroy func. Initialize the parameters array with
	zero in infc_request_manager_add_request_valist() because the GValues
	therein need to be zero-initialized.

	* test/inf-test-browser.c:
	* test/Makefile.am: Added (interactive) test for InfcBrowser
	connecting to a running infinote server.

2007-07-20  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-error.h:
	* libinfinity/common/inf-error.c: Added
	INF_DIRECTORY_ERROR_ALREADY_SUBSCRIBED.

	* libinfinity/common/inf-xml-util.c: Fixed error formatting for
	inf_xml_util_string_to_uint().

	* libinfinity/server/infd-directory.c: Changed "subscribe-session"
	reply request name to from "session-subscribe" to "subscribe-session"
	and set ID attribute in that request. Don't leak the identifier string
	in infd_directory_handle_subscribe_session().

	* libinfinity/client/infc-explore-request.c: Implement default signal
	handlers for the "initiated" and "progress" signals that notify the
	corresponding properties.

	* libinfinity/client/infc-request-manager.h:
	* libinfinity/client/infc-request-manager.c: Changed
	infc_request_manager_add_request(InfcRequestManager*, InfcRequest*) to
	infc_request_manager_add_request(InfcRequestManager*, GType, const
	gchar*, const gchar*, ...) and added
	infc_request_manager_add_request_valist().

	* libinfinity/client/infc-node-request.h:
	* libinfinity/client/infc-node-request.c: Added another request type
	that handles requests related to nodes in the directory tree.

	* libinfinity/client/infc-browser-iter.h:
	* libinfinity/client/infc-browser-iter.c:
	* libinfinity/client/infc-browser.h:
	* libinfinity/client/infc-browser.c: Implemented InfcBrowser class
	that allows browsing a remote directory tree.

	* libinfinity/client/Makefile.am: Build the new files.

2007-07-19  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-error.h:
	* libinfinity/common/inf-error.c: Replaced several "this or that
	attribute is missing" error by a general "No such attribute" error.

	* libinfinity/client/infc-request-manager.h:
	* libinfinity/client/infc-request-manager.c: Added
	infc_request_manager_get_request_by_xml_required().

	* libinfinity/common/inf-xml-util.h:
	* libinfinity/common/inf-xml-util.c:
	* libinfinity/common/Makefile.am: Added some common helper functions
	read attributes from a XML node.

	* libinfinity/client/infc-session.c:
	* libinfinity/server/infd-session.c:
	* libinfinity/server/infd-directory.c: Make use of them.

2007-07-17  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-marshal.in: Added VOID:UINT and VOID:UINT,UINT
	marshallers.

	* libinfinity/common/inf-error.h:
	* libinfinity/common/inf-error.c: Added INF_REQUEST_ERROR_INVALID_SEQ,
	INF_DIRECTORY_ERROR_TOO_MUCH_CHILDREN and
	INF_REQUEST_ERROR_TOO_FEW_CHILDREN.

	* libinfinity/server/infd-directory.h:
	* libinfinity/server/infd-directory.c: Removed g_return_if_fail from
	non-public functions, initialize next and prev fields of root node to
	NULL, unref session if corresponding node is freed, send number of
	child nodes in explore-begin.

	* libinfinity/client/infc-request-manager.h:
	* libinfinity/client/infc-request-manager.c: Added InfcRequestManager
	class that stores pending requests and provides lookup by seq.

	* libinfinity/client/infc-request.h:
	* libinfinity/client/infc-request.c: Removed the succeeded signal
	because it was too specific. It should rather be implemented by
	subclasses.

	* libinfinity/client/infc-user-request.h:
	* libinfinity/client/infc-user-request.c:
	* libinfinity/client/infc-explore-request.h:
	* libinfinity/client/infc-explore-request.c: Implemented specific
	requests for those which affect a user and for exploring a
	subdirectory.

	* libinfinity/client/infc-session.h:
	* libinfinity/client/infc-session.c: Use request manager instead of
	managing the requests on our own, use InfcUserRequest in
	infc_session_join_user and infc_session_leave_user.

	* libinfinity/client/Makefile.am: Added new source files to build.

	* README: Updated dependencies of infinote.

2007-07-15  Armin Burgmeier  <armin@arbur.net>

	* artwork/infinote.svg: Added infinote icon by Benjamin Herr.

2007-06-21  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-error.h:
	* libinfinity/common/inf-error.c: Moved directory error codes to
	common so they can be checked on client side.

	* libinfinity/server/infd-directory.h:
	* libinfinity/server/infd-directory.c: Added correct request handling.

2007-06-21  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-session.h:
	* libinfinity/common/inf-session.c: Make sure that the synchronization
	terminates correctly when both sender and receiver sessions are closed
	any time during synchronization.

2007-05-27  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-error.h:
	* libinfinity/common/inf-error.c: Added some more error codes. Those
	are only used on the client side and so should probably moved into
	somewhere in libinfinity/client.

	* libinfinity/client/infc-request.h:
	* libinfinity/client/infc-request.c: Added seq and name properties.

	* libinfinity/client/infc-session.h:
	* libinfinity/client/infc-session.c:
	* libinfinity/client/Makefile.am: Implemented client-side session.

2007-05-19  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-error.h:
	* libinfinity/common/inf-error.c: Added INF_USER_LEAVE_NO_SUCH_USER
	error code, InfRequestError codes and public API to access error
	quarks.

	* libinfinity/server/infd-session.h:
	* libinfinity/server/infd-session.c: Made xmlNodePtr non-const in
	InfdSessionMessageFunc because it only makes the pointer const (and
	not the XML node pointed to).

	* libinfinity/client/infc-request.h:
	* libinfinity/client/infc-request.c: Added a general request-specific
	pointer parameter to the succeeded signal.

	* docs/terminology: Added a few words about request and seq.

2007-04-18  Armin Burgmeier  <armin@arbur.net>

	* configure.ac:
	* libinfinity/Makefile.am: Added client directory, create
	libinfinity/client/Makefile.

	* libinfinity/inf-marshal.in: Added VOID:VOID marshaller.

	* libinfinity/common/infd-request.h:
	* libinfinity/common/infd-request.c:
	* libinfinity/common/Makefile.am: Added InfcRequest class.

	* libinfinity/common/inf-session.h:
	* libinfinity/common/inf-session.c:
	* libinfinity/server/infd-session.c: Replace user_to_xml vfunc by
	set_xml_user_props, added inf_session_user_to_xml which implements the
	functionality via the new vfunc.

2007-04-12  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/test/inf-test-daemon.c:
	* libinfinity/test/Makefile.am: Added test file that launches a simple
	infinote daemon with a filesystem storage in $HOME/.infinote.

2007-04-12  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/server/infd-filesystem-storage.h:
	* libinfinity/server/infd-filesystem-storage.c:
	* libinfinity/server/Makefile.am: Added a simple storage
	implementation that maps the directory tree to the disk.

2007-04-11  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/server/infd-server-pool.h:
	* libinfinity/server/infd-server-pool.c:
	* libinfinity/server/Makefile.am: Renamed from
	infd-server.[ch], manages an arbitrary amount of InfdXmlServers.

2007-04-10  Armin Burgmeier  <armin@arbur.net>

	* libinfintiy/common/inf-connection-manager.h:
	* libinfintiy/common/inf-connection-manager.c: Removed
	inf_connection_manager_add_connection, and add connection
	automatically on first invocation of
	inf_connection_manager_add_object.

	* libinfinity/common/inf-session.c:
	* libinfinity/server/infd-directory.c: Adjusted use.

2007-04-10  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-xmpp-connection.c: Fixed bugs, server side
	mostly works.

	* libinfinity/server/infd-xml-server.h: Fixed typo in
	InfdXmlServerStatus typedef.

	* libinfinity/server/infd-xmpp-server.h:
	* libinfinity/server/infd-xmpp-server.c: Build and Runtime fixes, use
	key.pem and cert.pem as key files for now. This should probably be
	replaced with a newly-created certificate later.

	* test/inf-test-xmpp-server.c: Added simple XMPP server test.

	* test/inf-test-xmpp-connection.c: Connect to local server instead of
	jabber.0x539.de.

	* test/key.pem:
	* test/cert.pem: Temporary example key files, copied from the GnuTLS
	distribution.

2007-04-08  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-xmpp-connection.c: Notify credentials and
	sasl-context properties when they are created.

	* libinfinity/server/infd-xmpp-server.h:
	* libinfintiy/server/infd-xmpp-server.c:
	* libinfinity/server/Makefile.am: Added XMPP server class,
	yet untested.

2007-03-29  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/server/infd-tcp-server.h:
	* libinfinity/server/infd-tcp-server.c: Added InfdTcpServer object.

	* libinfinity/server/infd-xml-server.h:
	* libinfinity/server/infd-xml-server.c: Added InfdXmlServer interface.

	* libinfinity/common/inf-tcp-connection.c: Added
	_inf_tcp_connection_accepted function, do not leak a socket if the
	connection attempt fails in inf_tcp_connection_open, do not chain up
	to finalize in dispose, do not leak the IO object, don't rely on errno
	keeping its value at the end of the recv/send loop.

	* test/inf-test-tcp-server.c:
	* test/Makefile.am: Added test for the TCP server.

2007-03-28  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/inf-xmpp-connection.c: Fixed some bugs, client
	part mostly works.

	* libinfinity/common/inf-tcp-connection.c: Exit receiving/sending loop
	if the connection has been closed in a received/sent signal handler.

	* libinfinity/common/inf-xml-connection.c: Initialize interface only
	once.

	* test/inf-test-xmpp-connection.c:
	* test/Makefile.am: Added XMPP client test.

2007-03-28  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/common/: Moved all libinfinity sources and headers
	except inf-config.h and inf-marshal.h into a subdirectory.

	* libinfinity/server/: Moved all libinfinited files into another
	subdirectory.

	* libinfinited/: Removed.

	* libinfinity/common/Makefile.am:
	* libinfinity/server/Makefile.am:
	* libinfinity/Makefile.am:
	* configure.ac: Adjusted build for new directory structure.

2070-03-27  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-xmpp-connection.h:
	* libinfinity/inf-xmpp-connection.c: Added XMPP client and server
	implementation, yet untested.

	* libinfinity/inf-xml-stream.h:
	* libinfinity/inf-xml-stream.c: Removed, this is no longer used and
	replaced by XMPP.

	* configure.in:
	* libinfinity/Makefile.am: Depend on gnutls and libgsasl.

2007-03-19  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-marshal.in: Added VOID:POINTER,UINT marshaller.

	* libinfinity/inf-standalone-io.h:
	* libinfinity/inf-standalone-io.c: Added simple InfIo implementation.

	* libinfinity/inf-tcp-connection.h:
	* libinfinity/inf-tcp-connection.c: Implemented a TCP connection
	object.

	* libinfinity/Makefile.am: Added InfIoStandalone and InfTcpConnection
	to build.

	* test/inf-test-stream.xml:
	* test/inf-test-xml-stream.c: Removed those since InfXmlStream will
	probably be removed too, or at least change semantics.

	* test/inf-test-tcp-connection.c:
	* test/Makefile.am: Added simple TCP connection test.

2007-03-18  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-ip-address.h:
	* libinfinity/inf-ip-address.c:
	* Makefile.am: Boxed type managing an IP address.

2007-03-18  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-discovery-info.h:
	* libinfinity/inf-discovery.h:
	* libinfinity/inf-discovery-info.c:
	* libinfinity/inf-discovery.c:
	* Makefile.am: Added InfDiscovery and InfDiscoveryInfo interfaces.

2007-03-17  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-io.h:
	* libinfinity/inf-io.c:
	* Makefile.am: Added InfIo interface.

2007-03-15  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-xml-connection.h: 
	* libinfinity/inf-xml-connection.c: Added an InfXmlConnection
	interface that replaces GNetworkConnection.

	* libinfinity/inf-buffer.c:
	* libinfinity/inf-buffer.h: Made a property out of the read-only
	functions and signal.

	* libinfinity/inf-marshal.in: Replaced VOID:BOOLEAN by VOID:POINTER
	for InfXmlConnection.

	* libinfinity/inf-net-object.h:
	* libinfinity/inf-connection-manager.h:
	* libinfinity/inf-session.h:
	* libinfinited/infd-note-plugin.h:
	* libinfinited/infd-session.h:
	* libinfinited/infd-directory.h:
	* libinfinity/inf-net-object.c:
	* libinfinity/inf-connection-manager.c:
	* libinfinity/inf-session.c:
	* libinfinited/infd-session.c:
	* libinfinited/infd-directory.c: Adjusted to use InfXmlConnection
	instead of GNetworkConnection.

	* configure.ac:
	* libinfinity/Makefile.am:
	* libinfinited/Makefile.am: Dropped dependency on libgnetwork. Also
	excluded infd-server.[hc] from build because they would still require
	GNetworkServer. Another interface in libinfinited is required here.

2007-03-15  Armin Burgmeier  <armin@arbur.net>

	* libinfinited/infd-storage.h:
	* libinfinited/infd-storage.c: Turned the path field of
	InfdStorageNode to name.

	* libinfinited/infd-directory.h:
	* libinfinited/infd-directory.c: Implemented remaining functionality
	that was missing, some more enhanced operations like copying or moving
	nodes are still not supported, though.

2007-03-12  Armin Burgmeier  <armin@arbur.net>

	* libinfinited/infd-storage.h:
	* libinfinited/infd-storage.c: Renamed InfdDirectoryStorage to
	InfdStorage.

	* libinfinited/infd-note-plugin.h: Added interface for a note plugin.

	* libinfinited/infd-session.h:
	* libinfinited/infd-session.c:
	* libinfinined/Makefile.am: Implemented user joins.

2007-03-12  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-user.h:
	* libinfinity/inf-user.c: Removed connection field again. I don't
	think it is useful.

	* libinfinity/inf-session.h:
	* libinfinity/inf-session.c: Added
	inf_session_get_synchronization_status() and an exclude parameter to
	the validate_user_props vfunc.

	* libinfinity/inf-error.h:
	* libinfinity/inf-error.c:
	* libinfinity/Makefile.am: These specify some error codes that are
	commonly used by client and server.

2007-03-08  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-session.c: Connect to notify::status to find out
	when a connection is closed.

2007-03-08  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-session.h:
	* libinfinity/inf-session.c: Provide getters for connection manager
	and buffer. Also do a ref on the connection we get in
	inf_session_synchronize_to() because it will be unrefed when the
	synchronization is complete or failed.

2007-03-08  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-session.c: Before removing the session from the
	connection manager in inf_session_release_connection(), make sure that
	the connection manager still has the connection. If the connection was
	closed, the connection manager might have dropped the connection
	earlier.

	* libinfinity/inf-connection-manager.c: Refcount netobject
	registrations, but make sure objects are added with the same
	identifier.

2007-03-08  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-user.h:
	* libinfinity/inf-user.c: Added a connection field to InfUser
	specifiying a (not necessarily direct) connection between the local
	host and that user.

2007-03-07  Armin Burgmeier  <armin@arbur.net>

	* docs/plugin: Added notes about the plugin interface. It is not yet
	implemented, these are my just ideas how it should work, so I do not
	forget and could be expanded to a complete specification later.

2007-03-06  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-marshal.in: Added VOID:OBJECT,DOUBLE and
	VOID:OBJECT,POINTER marshallers for synchronization signals.

	* libinfinity/inf-net-object.h:
	* libinfinity/inf-net-object.c:
	* libinfinity/inf-connection-manager.h:
	* libinfinity/inf-connection-manager.c: Implemented separation between
	inner and outer queue, added enqueued vfunc in InfNetObject.

	* libinfinity/inf-session.h:
	* libinfinity/inf-session.c: Implemented session synchronization.

	* libinfinity/inf-buffer.c: Minor build fixes.

	* libinfinity/docs/terminology: Added inner queue and outer queue of
	connection manager.

	* libinfinity/docs/session: Applied slight changes that came up during
	implementation.

2007-03-01  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/docs:
	* libinfinity/docs/terminology:
	* libinfinity/docs/session: Added some notes, mostly for me to not
	forget how things are supposed to work, but perhaps also interesting
	to others.

2007-03-01  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-marshal.in: Added VOID:BOOLEAN marshaller.

	* libinfinity/inf-buffer.h:
	* libinfinity/inf-buffer.c:
	* libinfinity/Makefile.am: Added common buffer interface.

	* libinfinity/inf-text-buffer.c:
	* libinfinity/inf-ink-buffer.c: Changed prerequiste from GObject to
	InfBuffer.

2007-02-27  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/infd-directory.h:
	* libinfinity/infd-directory.c: Added some directory API, but most
	implementations are still missing.

2007-02-27  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-marshal.in: Added marshallers required for
	InfTextBuffer.

	* libinfinity/inf-text-buffer.h:
	* libinfinity/inf-text-buffer.c:
	* libinfinity/Makefile.am: Added InfTextBuffer interface.

	* libinfinited/inf-directory-storage.h:
	* libinfinited/inf-directory-storage.c: Added methods to read text
	notes, write ink and text notes, create a subdirectory and
	remove nodes.

2007-02-26  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-connection-manager.h:
	* libinfinity/inf-connection-manager.c: Added
	inf_connection_manager_has_connection(). Also do strong refs instead
	of weak refs on added net object. This way, net objects are kept alive
	if there are still connections open. Especially, this should allow
	keeping sessions alive even if the document in the directory tree is
	removed.

	* libinfinited/infd-server.h:
	* libinfinited/infd-server.c:
	* libinfinited/Makefile.am: New server class managing acception of
	incoming connections and (yet to come) service publishing.

	* libinfinited/infd-directory.h:
	* libinfinited/infd-directory.c: Implemented directory tree structure,
	but accessing background storage and handling client requests still
	missing.

2007-02-26  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-marshal.in: Added VOID:OBJECT marshaller.

	* libinfinity/inf-user.h:
	* libinfinity/inf-user.c:
	* libinfinity/inf-session.h:
	* libinfinity/inf-session.c:
	* Makefile.am: Added InfUser and InfSession classes.

	* libinfinity/inf-ink-buffer.c: Changed signal flags for the
	remove-stroke signal from G_SIGNAL_RUN_CLEANUP to G_SIGNAL_RUN_LAST
	and surrounded the signal emission by a g_object_ref / g_object_unref
	pair. This way, the stroke should stay alive after having been removed
	from the buffer and signal handlers running after the default handler
	don't get corrupted memory.

2007-02-23  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-ink-stroke.h:
	* libinfinity/inf-ink-stroke.c: Renamed from InfStroke to
	InfInkStroke.

	* libinfinity/inf-ink-buffer.h:
	* libinfinity/inf-ink-buffer.c: Made an interface out of InfBuffer,
	renamed to InfInkBuffer.

	* libinfinity/Makefile.am: Adjusted build rules for renamed files.

	* libinfinited/infd-directory-storage.h:
	* libinfinited/infd-directory-storage.c: Include inf-ink-buffer.h
	instead of inf-buffer.h, added text node type for upcoming
	collaborative text editing support, removed empty flag from node
	(client should query a node to check whether it is empty, this way it
	can also treat it as empty if it only contains nodes it is not
	interested in, for example a subdirectory containing only ink nodes
	will be shown empty in a text editor).

2007-02-21  Armin Burgmeier  <armin@arbur.net>

	* libinfinited/infd-directory.h:
	* libinfinited/infd-directory.c: Added GNetworkTcpServer object, close
	on error.

2007-02-21  Armin Burgmeier  <armin@arbur.net>

	* libinfinity/inf-connection-manager.c: Take a reference of the
	connection in inf_connection_manager_add_connection().

	* libinfinited/infd-directory.c:
	* libinfinited/infd-directory-storage.c:
	* libinfinited/infd-directory.h:
	* libinfinited/infd-directory-storage.h:
	* libinfinited/infd-marshal.in:
	* libinfinited/Makefile.am: Added interface for directory storage in
	libinfinited and initial directory class.

	* Makefile.am:
	* configure.ac: Build libinfinited.

2007-02-21  Armin Burgmeier  <armin@arbur.net>

	* libinfinity: Renamed infinity directory to libinfinity.

	* configure.ac:
	* Makefile.am:
	* test/Makefile.am:
	* test/inf-test-xml-stream.c:
	* libinfinity/*.[ch]: Changed references and includes from infinity to
	libinfinity. Also implemented inf_stroke_new_at().

2007-02-21  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-net-object.c: Add G_TYPE_OBJECT prerequisite.

2007-02-20  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-connection-manager.c:
	* infinity/inf-xml-stream.c: Chain up in destructor.

	* infinity/inf-buffer.h:
	* infinity/inf-buffer.c: Added InfBuffer class managing multiple
	InfStrokes.

	* infinity/inf-marshal.in: Added input file for glib-genmarshal.

	* infinity/Makefile.am: Create inf-marshal.h and inf-marshal.c from
	inf-marshal.in. Also added inf-buffer.c to build.

2007-02-20  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-stroke.h:
	* infinity/inf-stroke.c: Added position to InfStroke to which
	the coordinates of the contained InfStrokePoints are relative.

2007-02-20  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-xml-stream.c:
	* infinity/inf-connection-manager.c: Documentation fixes.

	* infinity/inf-net-object.c: Removed return in inf_net_object_sent()
	and inf_net_object_received() because these functions are void.

	* infinity/inf-stroke.h:
	* infinity/inf-stroke.c: Added object representing a single stroke.

	* infinity/Makefile.am: Added inf-stroke.c to build.

2007-02-19  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-connection-manager.h:
	* infinity/inf-connection-manager.c: Implemented message processing
	and inf_connection_manager_send_to_object().

2007-02-19  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-xml-stream.c:
	* infinity/inf-xml-stream.h:
	* infinity/Makefile.am: Added InfXmlStream class.

	* test/inf-test-xml-stream.c:
	* test/inf-test-stream.xml:
	* test/Makefile.am: Simple test routine to test functionality of
	InfXmlStream.

	* configure.ac: Create test/Makefile.
	* Makefile.am: Added test to SUBDIRS.

2007-02-18  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-connection-manager.c:
	* infinity/inf-connection-manager.h: Added InfConnectionManager class,
	not yet fully implemented, but compilable.

	* infinity/Makefile.am: Added inf-connection-manager.[ch].

2007-02-18  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-net-object.h:
	* infinity/inf-net-object.c: Renamed inf-netobject.[ch] to
	inf-net-object.[ch].

2007-02-18  Armin Burgmeier  <armin@arbur.net>

	* infinity/inf-netobject.h: Replaced INF_NET_OBJECT_TYPE by
	INF_TYPE_NET_OBJECT to follow gobject naming conventions.

2007-02-18  Armin Burgmeier  <armin@arbur.net>

	* configure.ac: Added check for glib, gobject, libgnetwork and
	libxml2.

	* infinity/Makefile.am: Add CFLAGS and libs of dependencies to
	libinfinity_1_0_la_CPPFLAGS respectively libinfinity_1_0_la_LIBADD.

	* infinity/inf-netobject.h: Added libgnetwork/gnetwork-connection.h
	and libxml/tree.h includes to make it actually compile.

	* infinity/inf-config.h.in: Removed generated file from repository.

2007-02-16  Armin Burgmeier  <armin@arbur.net>

	* configure.ac:
	* Makefile.am:
	* AUTHORS:
	* NEWS:
	* README:
	* COPYING:
	* INSTALL:
	* infinity/Makefile.am:
	* infinity/inf-config.h.in:
	* infinity/inf-netobject.h:
	* infinity/inf-netobject.c: Initial revision.
